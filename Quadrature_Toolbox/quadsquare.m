function Q = quadsquare(d,varargin)

%% QUADSQUARE Quadrature weights and points for the square
%    Q = QUADSQUARE(d) returns the weights and points of a Gauss–Legendre
%    product rule of degree d for numerically integrating over a square 
%    domain S = [-1,1]×[-1,1]. The output is stored as a structure Q with 
%    the following fields:
%       »  Q.Points = the n quadrature points in an array of size n×2, 
%          where Q.Points(:,1) and Q.Points(:,2) are the x and y 
%          coordinates, respectively.
%       »  Q.Weights = the corresponding quadrature weights stored in a 
%          column vector of length n.
%       »  Q.Properties = contains (sub)fields describing the .Degree (the 
%          input value d), the .Type (see description below) and the 
%          .Domain of integration of the quadrature rule.
%
%    Q = QUADSQUARE(d,Name,Value) same as above but with additional control
%    over the type of rules returned. Options include specification of the
%    following Name-Value pair arguments: 
%    ______________________________________________________________________
%    'Type' — Type of quadrature rule
%    'productLegendre' (default) | 'productLobatto' | 'nonproduct'
%    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  
%    The type of quadrature rule may be specified as 'productLegendre' (the
%    default), in which case the points and weights of a Gauss-Legendre
%    product rule are returned, as 'productLobatto', in which case the 
%    points and weights of a Gauss-Lobatto product rule are returned, or as 
%    'nonproduct'. Product rules can be of arbitrary degree, while non-
%    product rules are currently available up to degree 21.
%
%    The following additional Name-Value pairs are available for nonproduct 
%    rules:
%    ______________________________________________________________________
%    'Symmetry' — Symmetry of the quadrature rule
%    'full' (default) | 'allowAsymmetric'
%    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  
%    The 'full' (default) value requires the quadrature rule to be fully 
%    symmetric. The value 'allowAsymmetric' allows asymmetric quadrature 
%    rules of lower point count than the full symmetry rules to be returned
%    when available. (Note: Some quadrature rules possess so-called partial
%    symmetry, though no distinction is made here between asymmetric and
%    partially symmetric rules, i.e., a rule is classified as either fully
%    symmetric or asymmetric.)
%    ______________________________________________________________________
%    'Weights' — Quadrature weight conditions
%    'positive' (default) | 'allowNegative'
%    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
%    The 'postive' (default) value requires all quadrature weights to be 
%    positive. The value 'allowNegative' allows quadrature rules with nega-
%    tive weight(s) of lower point count than the positive weight rules to
%    be returned when available.
%    ______________________________________________________________________
%    'Points' — Location of quadrature points
%    'inside' (default) | 'allowOutside'
%    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
%    The 'inside' (default) value requires all points to be inside the do-
%    main. The value 'allowOutside' allows quadrature rules with point(s)  
%    outside the domain of lower point count than the quadrature rules 
%    with all points inside to be returned when available.
%    ______________________________________________________________________                 
%
%    Note: The default Name-Value pairs for nonproduct rules are set such 
%    that the minimal-point, fully symmetric so-called PI rule (that is,  
%    all weights are Positive and all points are Inside the domain) of 
%    degree d is returned. Fully symmetric PI rules are generally preferred 
%    among practitioners.
%
%    Functional dependencies: quadGaussLegendre and quadGaussLobatto
%
%    See also quadGaussLegendre, quadGaussLobatto, quadtriangle
%
%    Detailed help, with examples, available online at: 
%    http://u.osu.edu/kubatko.3/codes_and_software/quadtools/quadsquare/

%% Validate data passed to function

vd = @(x)validateattributes(x,{'numeric'},{'scalar','integer','>=',0});
vT = @(x)validateattributes(x,{'char'},{'nonempty'});
ip = inputParser;
ip.addRequired('d',vd);
ip.addParameter('Type','productLegendre',vT);
ip.addParameter('Symmetry','full')
ip.addParameter('Weights','positive'),
ip.addParameter('Points','inside');
ip.parse(d,varargin{:}); ip.Results; 
Type = ip.Results.Type; 
Symmetry = ip.Results.Symmetry; Weights  = ip.Results.Weights; 
Points = ip.Results.Points; 

%% Compute quadrature weights and points

switch Type
    %% Product Rules
    case 'productLegendre'
        Q = quadGaussLegendre(ceil((d+1)/2));        
        Q = quadSquareProduct(Q);
        Type = 'Gauss-Legendre product';
    case 'productLobatto'
        Q = quadGaussLobatto(ceil((d+3)/2));
        Q = quadSquareProduct(Q);        
        Type = 'Gauss-Lobatto product';
    case {'nonproduct','Nonproduct'}
        %% Nonproduct rules
        if ~any(strcmpi(Symmetry,{'full','allowAsymmetric'}))
            error(['The value of ''Symmetry'' is invalid. Expected input to be:',...
                ' ''full'' (default) or ''allowAsymmetric''.']);
        end
        if ~any(strcmpi(Weights,{'positive','allowNegative'}))
            error(['The value of ''Weights'' is invalid. Expected input to be:',...
                ' ''positive'' (default) or ''allowNegative''.']);
        end
        if ~any(strcmpi(Points,{'inside','allowOutside'}))
            error(['The value of ''Points'' is invalid. Expected input to be:',...
                ' ''inside'' (default) or ''allowOutside''.']);
        end
        Q = quadSquareNonproduct(d,Symmetry,Weights,Points);
    otherwise
        error(['The value of ''Type'' is invalid. Expected input to be:',...
            ' ''productLegendre'', ''productLobatto'', or ''nonproduct''.']);
end
Q.Properties.Degree = d;
Q.Properties.Type = Type;
Q.Properties.Domain = [-1 -1; 1 -1; 1 1; -1 1];

end

%% Supporting function(s) =================================================

%% Function for product quadrature rules
function Qp = quadSquareProduct(Q)
[X,Y] = meshgrid(Q.Points,Q.Points);
Qp.Points = [X(:),Y(:)];
Qp.Weights = kron(Q.Weights,Q.Weights);
end

%% Functions for non-product quadrature rules
function Q = quadSquareNonproduct(d,Symmetry,Weights,Points) 

vd = @(x)validateattributes(x,{'numeric'},{'scalar','nonnegative','integer','<=',25});
ip = inputParser;
ip.addRequired('d',vd);
ip.parse(d); ip.Results;

Qf = str2func(['quadSquareNonProductDegree',num2str(d)]);
Qn = Qf(Symmetry,Weights,Points);
Q  = quadSquareNonProductPointsAndWeights(Qn);

end

%%
%  
%  Notes:
% 
%  The quadrature rules are described in the comments below by the follow-
%  ing designations:
%    (1) The degree of the quadrature rule. A quadrature rule is said to be 
%        of degree d if it can integrate all polynomials up to degree d 
%        exactly.
%    (2) The number of points. An asterik, e.g., 3* Points, indicates that 
%        the rule is a minimal-point rule, that is, it achieves the known
%        lower bound for the number of points of a quadrature rule of 
%        degree d over the square. This lower bound is given by
%
%            { (d+2)(d+4)/8                    if d is even
%        N = { 
%            { (d+1)(d+3)/8 + floor((d+1)/4)   if d is odd
%           
%        see, for example, Equation (3) on page 4296 of [F1].
%    (3) A two-letter designations indicating the "quality" of the weights 
%        and points: PI, NI, PO, or NO, where 'P' indicates the positivity 
%        of all weights, 'N' indicates the presence of a negative weight
%        (or weights), 'I' indicates all points are inside the triangle, 
%        and 'O' indicates a point (or points) are outside of the triangle.
%    (4) The symmetry of the quadrature rule: fully symmetric, Rotationally 
%        symmetric, or asymmetric.
%    (5) Reference from which the quadrature points and weights were
%        obtained. (Note: These references are not necessarily the first 
%        reference to publish the particular rule, though great effort has 
%        been made to identify the first reference.)
%
% For example: Degree 7, 12* Points, PI, Fully symmetric, Reference: [T2]
%                (1)         (2)    (3)        (4)            (5)
%
%  Table summarizing the number of points in the available nonnproduct 
%  square rules (* denotes the rule achieves the lower bound):         
%
%  ========================================================================
%  |      |     ||           R  U  L  E      Q  U  A  L  I  T  Y          |
%  |      |     ||________________________________________________________|
%  |Degree|     ||    Not fully symmetric    ||      Fully symmetric      |
%  |  of  |Lower||___________________________||___________________________|       
%  | Rule |Bound||  NO  |  PO  |  NI  |  PI  ||  NO  |  PO  |  NI  |  PI  |
%  ========================================================================
%  |  1  |   1  ||      |      |      |      ||      |      |      |   1* |
%  |  2  |   3  ||      |      |      |   3* ||      |      |      |   4  |
%  |  3  |   4  ||      |      |      |      ||      |      |      |   4* |
%  |  4  |   6  ||      |      |      |   6* ||      |      |      |   8  |
%  |  5  |   7  ||      |      |      |   7* ||      |      |      |   8  |
%  |  6  |  10  ||      |      |      |  10* ||      |      |      |  12  |
%  |  7  |  12  ||      |      |      |      ||      |      |      |  12  |
%  |  8  |  15  ||      |  15* |      |  16  ||      |      |      |  20  |
%  |  9  |  17  ||      |      |      |  17* ||      |      |      |  20  |
%  | 10  |  21  ||      |      |      |  22  ||      |  25  |  25  |  28  |
%  | 11  |  24  ||      |      |      |  24* ||      |  25  |  25  |  28  |
%  | 12  |  28  ||      |      |      |  31  ||      |  36  |      |  37  |
%  | 13  |  31  ||      |      |      |  33  ||      |  36  |      |  37  |
%  | 14  |  36  ||      |      |      |  40  ||  45  |      |      |  48  |
%  | 15  |  40  ||      |      |      |  44  ||  45  |      |      |  48  |
%  | 16  |  45  ||      |      |      |  52  ||  57  |      |      |  60  |
%  | 17  |  49  ||      |      |      |  54  ||  57  |      |      |  60  |
%  | 18  |  55  ||      |      |      |  64  ||  68  |      |      |  72  |
%  | 19  |  60  ||      |      |      |  67  ||  68  |      |      |  72  |
%  | 20  |  66  ||      |      |      |  78  ||      |      |      |  85  |
%  | 21  |  71  ||      |      |      |  81  ||      |      |      |  85  |
%  ========================================================================  
%
%  References:
%  
%  [B1] W. Burnside, "An approximate quadrature formula," The Messenger of 
%       Mathematics, 37, 166–167, 1908.
%  [C1] R. Cools and A. Haegemans, "Another step forward in searching for
%       cubature formulae with a minimal number of knots for the square,"
%       Computing, 40, 139–146, 1988. 
%  [C2] R. Cools and A. Haegemans, "Construction of fully symmetric 
%       cubature formulae of degree 4k - 3 for fully symmetric planar 
%       regions," Report TW 71, Dept. of Computer Science, K.U. Leuven, 
%       1985.
%  [C3] R. Cools, "An encyclopaedia of cubature formulas," Journal of 
%       Complexity, 19, 445–453,2003. Online database at: 
%       http://nines.cs.kuleuven.be/ecf/%
%  [D1] D. Dunavant, "Economical symmetrical quadrature rules for complete
%       polynomials over a square domain," International Journal for Numer-
%       ical Methods in Engineering, 21, 1777–1784, 1985.
%  [F1] M. Festa and A. Sommariva, "Computing almost minimal formulas on 
%       the square," Journal of Computational and Applied Mathematics, 236,
%       4296-4302, 2012. Online supplemental material at:
%       https://www.math.unipd.it/~alvise/POINTSETS/set_amr_square.m
%  [M1] C.R. Morrow and T.N.L. Patterson, C"onstruction of algebraic 
%       cubature rules using polynomial ideal theory," SIAM Journal on 
%       Numerical Analysis, 15 953–976, 1978.
%  [M2] H.M. Möller, "Minimum-Point Cubature Formulas," Numerische Mathe-
%       matik, 25, 185–200, 1976. (in German)
%  [O1] I.P. Omelyan and V.B Solovyan, "Improved cubature formulae of high 
%       degrees of exactness for the square," Journal of Computational and 
%       Applied Mathematics, 188, 190–204, 2006.
%  [P1] R. Piessans and A. Haegmans, "Cubature formulas of degree eleven 
%       for symmetric planar regions," Journal of Computational and Applied 
%       Mathematics, 1, 79–83, 1975.
%  [R1] P. Rabinowitz and N. Richter, "Perfectly symmetric two-dimensional
%       integration formulas with minimal numbers of points," Mathematics 
%       of Computation, 23, 765–775, 1969.
%  [S1] A.H. Stroud, "Approximate calculation of multiple integrals,"
%       Prentice-Hall, Inc., 1971.
%  [S2] A.H. Stroud, "Some fifth-degree integration formulas for symmetric
%       regions," Mathematics of Computation, 20, 90–97, 1966.
%  [T1] M.A. Taylor, "Asymmetric cubature formulas for polynomial
%       integration in the triangle and square," Journal of Computational
%       and Applied Mathematics 218, 184--191, 2008.
%  [T2] G.W. Tyler, "Numerical integration of functions of several
%       variables," Canadian Journal of Mathematics, 5, 393–412, 1953.
%  [V1] P. Verlinden and R. Cools, "A cubature formula of degree 19 with 68 
%       nodes for integration over the square," Report TW 149, Dept. of 
%       Computer Science, K.U. Leuven, 1991.
%  [W1] J.W. Wissman and T. Becker, "Partially Symmetric Cubature Formulas 
%       for Even Degrees of Exactness", SIAM Journal on Numerical Analysis, 
%       23, 676–685, 1986.
%  [W2] F.D. Witherden and P.E. Vincent, "On the identification of symmet-
%       ric quadrature rules for finite element methods," Computers and
%       Mathematics with Applications, 69, 1232-1241, 2015.
%       Online supplmemental material available at:
%       http://dx.doi.org/10.1016/j.camwa.2015.03.017
%  [X1] H. Xiao and Z. Gimbutas, "A numerical algorithm for the construc-
%       tion of efficient quadrature rules in two and higher dimensions,"
%       Computers and Mathematics with Applications, 59, 663--676, 2010.
%       Online supplmemental material available at:
%       https://cims.nyu.edu/cmcl/quadratures/quadratures.html
%
%
%==========================================================================


%%
function Qn = quadSquareNonProductDegree1(varargin)
% Lower bound = 1
% _________________________________________________________________________
% Degree 1, 1* Point, PI, fully Symmetric, Reference: [Just think about it]
% ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
Qn.group = { 'n0' };
Qn.m = 1; Qn.xi1  = 0; Qn.xi2  = 0; Qn.w = 4;

end%*
%%
function Qn = quadSquareNonProductDegree2(varargin)
% Lower bound = 3

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 2, 3* Points, PI, Asymmetric, Reference: See Figure 3-2 on
        % page 86 of [S1].
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m    = [ 1, 1, 1 ];
        Qn.xi1  = [ sqrt(6)/3, -sqrt(6)/6, -sqrt(6)/6 ];
        Qn.xi2  = [         0,  sqrt(2)/2, -sqrt(2)/2 ];
        Qn.w    = [       4/3,        4/3,        4/3 ];
    case 'full'
        % _________________________________________________________________
        % Degree 2, 4 Points, PI, Fully symmetric, Reference: This is just
        % the Gauss-Legendre product rule of degree 3
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn = quadSquareNonProductDegree3(varargin);
end

end%*
%%
function Qn = quadSquareNonProductDegree3(varargin)
% Lower bound = 4
% _________________________________________________________________________
% Degree 3, 4* Points, PI, Fully symmetric, Reference: This is just the
% Gauss-Legendre product rule of degree 3
% ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
Qn.group = { 'n2' };
Qn.m = 4; Qn.xi1  = sqrt(1/3); Qn.xi2  = sqrt(1/3); Qn.w = 1;

end%*
%%
function Qn = quadSquareNonProductDegree4(varargin)
% Lower bound = 6

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 4, 6* Points, PI, Partially symmetric, References: [W1],
        % see page 683 (higher precision numerical values obtained from
        % [C3]).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = {'','','s2','s2'};
        Qn.m = [ 1 1 2 2 ];
        Qn.xi1 = [ 0.000000000000000000000000000000000,...
            0.000000000000000000000000000000000,...
            0.851914653304600491301835640366669,...
            0.630912788976754026243413202993658 ];
        Qn.xi2 = [ 0.000000000000000000000000000000000,...
            0.966091783079295904914577610477984,...
            0.455603727836192842249584745989760,...
            -0.731629951573134529368035491840613 ];
        Qn.w = [ 1.14285714285714285714285714285714,...
            0.439560439560439560439560439560439,...
            0.566072207007532105264050459451812,...
            0.642719001783676685944740749339395 ];
    case 'full'
        % _________________________________________________________________
        % Degree 4 (actually degree 5), 8 Points, PI, Fully Symmetric,
        % Reference: [B1]
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn = quadSquareNonProductDegree5(varargin{:});
end

end%*
%%
function Qn = quadSquareNonProductDegree5(varargin)
% Lower bound = 7

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 5, 7* Points, PI, Partially Symmetric, Reference:
        % Originally published in [S2], analytic expression obtained from
        % [S1], see formulas 5-6 on page 233.
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m    = [ 1, 1, 1, 1, 1, 1, 1 ];
        Qn.xi1 = sqrt(15)/5*[ 0, 0, 0, 1, 1, -1, -1 ];
        Qn.xi2 = sqrt(3)/3*[ 0, sqrt(70)/5, -sqrt(70)/5, 1, -1, 1, -1 ];
        Qn.w    = [ 8/7, 20/63, 20/63, 5/9, 5/9, 5/9, 5/9 ];
    case 'full'
        % _________________________________________________________________
        % Degree 5, 8 Points, PI, Fully Symmetric, Reference: [B1]
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = { 'n1' 'n2' };
        Qn.m     = [ 4, 4 ];
        Qn.xi1  = sqrt(7)/3*[ sqrt(15)/5, 1 ];
        Qn.xi2  = sqrt(7)/3*[ 0, 1 ];
        Qn.w     = 1/49*[ 40, 9 ];
end

end%*
%%
function Qn = quadSquareNonProductDegree6(varargin)
% Lower bound = 10

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 6, 10* Points, PI, Partially Symmetric, References: [W1],
        % see rule 6-1 on page 683. (Note: Higher precision numerical
        % values obtained from [C3]).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = {'','','s2','s2','s2','s2'};
        Qn.m    = [ 1, 1, 2, 2, 2, 2 ];
        Qn.xi1 = [ 0.000000000000000000000000000000000,...
            0.000000000000000000000000000000000,...
            0.888764014654764533853170471609380,...
            0.604857639464685027698532295335587,...
            0.955447506641063747757528360774788,...
            0.565459993438754045894375389139462 ];
        Qn.xi2 = [ 0.836405633697625604537901440708439,...
            -0.357460165391307184886174384445965,...
            0.872101531193130590032875340374412,...
            0.305985162155426661489382735682569,...
            -0.410270899466657838725680144555973,...
            -0.872869311156879339251259208496329 ];
        Qn.w   = [ 0.455343245714173438553541721312115,...
            0.827395973202965492356696938299033,...
            0.144000884599645384928603086560623,...
            0.668259104262665149929832544411851,...
            0.225474004890679357411055647855252,...
            0.320896396788440642275389391366698 ];
    case 'full'
        % _________________________________________________________________
        % Degree 6 (actually degree 7), 12 Points, PI, Fully symmetric,
        % References: [T2], see analytic expressions on page 403 and Figure
        % 4
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn = quadSquareNonProductDegree7(varargin{:});
end

end%*
%%
function Qn = quadSquareNonProductDegree7(varargin)
% Lower bound = 12
% _________________________________________________________________________
% Degree 7, 12 Points, PI, Fully symmetric, Reference: [T2], see analytic
% expressions on page 403 and Figure 4.
% ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
Qn.group = { 'n1' 'n2' 'n2'};
Qn.m     = [ 4, 4, 4 ];
Qn.xi1 = [ sqrt(6/7),...
    sqrt((114-3*sqrt(583))/287),...
    sqrt((114+3*sqrt(583))/287) ];
Qn.xi2  = [ 0,...
    sqrt((114-3*sqrt(583))/287),...
    sqrt((114+3*sqrt(583))/287) ];
Qn.w = [ 2*49/405, ...
    (178981+2769*sqrt(583))/472230,...
    (178981-2769*sqrt(583))/472230 ];

end%*
%%
function Qn = quadSquareNonProductDegree8(varargin)
% Lower bound = 15

switch varargin{1}
    case 'allowAsymmetric'
        switch varargin{3}
            case 'allowOutside'
                % _________________________________________________________
                % Degree 8, 15* Points, PO (1 point outside), Asymmetric,
                % References: [M1], see Table 1 on page 972. (Note: Higher
                % precision numerical values obtained from [C3]).
                % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Qn.m = [ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ];
                Qn.xi1 = [ 0.930819501498749453760637898907125,...
                    +0.329886608456164568746149981884296,...
                    -0.570410246299135591766684780238581,...
                    -0.931571920926692414748923836941892,...
                    +0.741326282816884513647899679499979,...
                    -0.185148788098972543568912438894377,...
                    +0.966352417331858938424052269020807,...
                    +0.320040669553448783113409140970763,...
                    -0.741629675015130862580356220958946,...
                    +0.743126677360954122245667389625096,...
                    -0.335537543654539002489370436402796,...
                    -0.973694412716911104541900744189639,...
                    +1.11583945353780327903207226918213,...
                    +0.130062587861372969518267512243956,...
                    -0.733066239583114499672976369605098 ];
                Qn.xi2 = [ 0.893698380616335238281119896293736,...
                    +0.883926136259239464924656309053374,...
                    +0.926221298449334870351608055664993,...
                    +0.702013653007312378913578293946826,...
                    +0.456133411159049823787828630603058,...
                    +0.499142392357643269213184459996807,...
                    -0.166471026372673216887138378610941,...
                    -0.121112589221205900170290435234217,...
                    +0.0859305932732320028579227244366775,...
                    -0.727489176518889672611315723507811,...
                    -0.504500049436508358571146353783925,...
                    -0.518552583832950294991979688354017,...
                    -1.21057711471916886325532789326571,...
                    -0.904915976125771312369835234463740,...
                    -0.901922593675519313972317618264552 ];
                Qn.w = [ 0.0720471011888976040650094283690655,...
                    0.249021499319344946611376629477799,...
                    0.162928081259617990323403511764428,...
                    0.135313571019584153815810781367274,...
                    0.359228351145242322950819230242710,...
                    0.534282626522569831292027619404150,...
                    0.142083252534611464165450869242879,...
                    0.610258631091993976451046515756859,...
                    0.412823325678768310061076934009795,...
                    0.317303143595545559249338410685257,...
                    0.494509600508250689379616231112990,...
                    0.114158382719121497571965938518423,...
                    4.71047054258195458310428810247947e-03,...
                    0.230380891117876253034660246552050,...
                    0.160951071755993446445293365393834 ];
            case 'inside'
                % _________________________________________________________
                % Degree 8, 16 Points, PI, Partially Symmetric, References:
                % [W1], see rule 8-1 on page 684. (Note: Higher precision
                % numerical values obtained from [C3]).
                % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Qn.group = {'','','','','s2','s2','s2','s2','s2','s2'};
                Qn.m    = [ 1, 1, 1, 1, 2, 2, 2, 2, 2, 2 ];
                Qn.xi1 = [ 0.000000000000000000000000000000000,...
                    0.000000000000000000000000000000000,...
                    0.000000000000000000000000000000000,...
                    0.000000000000000000000000000000000,...
                    0.639091304900369653403235264031721,...
                    0.937069076924990443752231080894769,...
                    0.537083530541493677897648105992718,...
                    0.887188506449624639019688248989493,...
                    0.494698820670196332024295661484865,...
                    0.897495818279767537534055839863289];
                Qn.xi2 = [ 0.000000000000000000000000000000000,...
                    0.757629177660505447524861821861556,...
                    -0.236871842255701893386442221726357,...
                    -0.989717929044526681314894835143122,...
                    0.950520955645666883587667956346444,...
                    0.663882736885633178362124306243645,...
                    0.304210681724104509042243267561976,...
                    -0.236496718536119480657253462930802,...
                    -0.698953476086563559924631569932018,...
                    -0.900390774211579733563473344120572 ];
                Qn.w = [ 0.0553647056214397722463360108549682,...
                    0.404389368726075413334289734948948,...
                    0.533546604952634455353276846892345,...
                    0.117054188786739206424718372281753,...
                    0.125614417613746804131857052238104,...
                    0.136544584733588467333147996141657,...
                    0.483408479211256951110265522381121,...
                    0.252528506429543693380340984676537,...
                    0.361262323882172569126067602177758,...
                    0.0854642540862470912390103598958135 ];
        end
    case 'full'
        % _________________________________________________________________
        % Degree 8 (actually degree 9), 20 Points, PI, Fully symmetric,
        % References: [R1], see Table 2 of page 775. (Note: Higher preci-
        % sion numerical values obtained from [C3]).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn = quadSquareNonProductDegree9(varargin{:});
        %
end

end%*
%%
function Qn = quadSquareNonProductDegree9(varargin)
% Lower bound = 17

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 9, 17* Points, PI, Rotationally symmetric, References:
        % [M2], see page 194. (Note: Higher precision numerical values ob-
        % tained from [C3]).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = { '', 'R4','R4','R4','R4'};
        Qn.m     = [ 1, 4, 4, 4, 4 ];
        Qn.xi1 = [ 0.000000000000000000000000000000000,...
            0.968849966361977720716690342978335,...
            0.750277099978900533535983982389359,...
            0.523735820214429336038287126639137,...
            0.0762083281926171731816268673893245 ];
        Qn.xi2 = [ 0.000000000000000000000000000000000,...
            0.630680119731668854173240280749044,...
            0.927961645959569667400753369383703,...
            0.453339821135647190762787641582085,...
            0.852615729333662307745214676518349 ];
        Qn.w = [ 0.526748971193415637860082304526748,...
            0.0888793781701987069670108862220825,...
            0.112099602129596485275898927025445,...
            0.398282439262070095276335716949795,...
            0.269051337639780803015733893670989 ];
    case 'full'
        % _________________________________________________________________
        % Degree 9, 20 Points, PI, Fully Symmetric, References: [R1],
        % see Table 2 of page 775. (Note 1: Higher precision numerical
        % values obtained from [C3]. Note 2: Same as degree 8 fully
        % symmetric rule above.)
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = { 'n1', 'n1', 'n2', 'n3' };
        Qn.m = [ 4 4 4 8 ];
        Qn.xi1 = [ 0.984539811942252392433000600300987,...
            0.488886342842372416227768621326681,...
            0.939567287421521534134303076231667,...
            0.836710325023988974095346291152195 ];
        Qn.xi2 = [ 0.000000000000000000000000000000000,...
            0.000000000000000000000000000000000,...
            0.939567287421521534134303076231667,...
            0.507376773674613005277484034493916 ];
        Qn.w = [ 0.0716134247098109667847339079718044,...
            0.454090352551545224132152403485726,...
            0.0427846154667780511691683400146727,...
            0.215755803635932878956972674263898 ];
end

end%*
%%
function Qn = quadSquareNonProductDegree10(varargin)
% Lower bound = 21

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 10, 22 Points, PI, Asymmetric, Reference: [T1] see
        % Appendix A on page 188 and Figure 2 (left) on page 187.
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m   = [ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ];
        Qn.xi1 = [ 4.7324898849276598e-01,...
            -3.5072672608918981e-01,...
            -4.7113921490701688e-01,...
            3.2110023120386515e-02,...
            1.0733227865108741e-01,...
            8.1037492260191812e-01,...
            -7.7882541598318511e-01,...
            -6.4763548426267536e-01,...
            3.9247487539609610e-01,...
            7.6050655071397388e-01,...
            -8.1171510601648733e-01,...
            -1.1429517364223797e-01,...
            7.5296563247996007e-01,...
            -6.2402437958984702e-01,...
            -2.0650134619887220e-01,...
            5.0891319042960681e-01,...
            -9.8171192640479688e-01,...
            -9.4061855719921172e-01,...
            -9.2254816825741193e-01,...
            9.5380192234255112e-01,...
            9.6634208368735852e-01,...
            9.5774959160007522e-01 ];
        Qn.xi2 = [ 1.6557852510038315e-01,...
            1.8447172062121983e-01,...
            -6.6664733059821124e-01,...
            -3.1879357593640706e-01,...
            6.1886619139299248e-01,...
            6.1159678303492504e-01,...
            -2.1052738914821550e-01,...
            6.4749469817525440e-01,...
            -7.6311149392438349e-01,...
            -3.6631391678067937e-01,...
            -9.2466842429053542e-01,...
            -9.4921913140887015e-01,...
            -9.7071837396777472e-01,...
            9.8538331193146012e-01,...
            9.1195887103573425e-01,...
            9.2152907557898267e-01,...
            -6.2586619353239670e-01,...
            3.1884535968392919e-01,...
            8.7923480439903223e-01,...
            -7.5512692061435549e-01,...
            1.0431232556636386e-01,...
            9.2621050012583894e-01 ];
        Qn.w = [ 3.7171764930896173e-01,...
            3.8811447402440874e-01,...
            2.8395842218278933e-01,...
            4.0824197726154576e-01,...
            3.1498878221231136e-01,...
            2.0018320620277513e-01,...
            2.6587113477126029e-01,...
            2.3057004553370086e-01,...
            2.5827939410342804e-01,...
            2.6042397681916851e-01,...
            8.8686202216975499e-02,...
            1.1861767207465973e-01,...
            5.9110195150351146e-02,...
            3.3387129247073037e-02,...
            1.3460977386198075e-01,...
            1.3337731192240113e-01,...
            6.3269272761110995e-02,...
            1.1984158532391266e-01,...
            6.2537941187552140e-02,...
            7.1805898760516657e-02,...
            9.7940429484131938e-02,...
            3.4467525588983812e-02 ];
    case 'full'
        switch varargin{2}
            case 'allowNegative'
                % _________________________________________________________
                % Degree 10 (actually degree 11), 25 Points, NI, Fully 
                % symmetric, References: [P1] see Table 1 on page 81 (Note: 
                % Higher precision numerical values obtained from [C3]).
                % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Qn = quadSquareNonProductDegree11(varargin{:});                
            case 'positive'
                switch varargin{3}
                    case 'allowOutside'
                        % _________________________________________________
                        % Degree 10 (actually degree 11), 25 Points, PO (4
                        % points outside), Fully symmetric, Reference: [R1]
                        % see Table 1 on page 775.
                        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                        Qn = quadSquareNonProductDegree11(varargin{:});
                    case 'inside'
                        % _________________________________________________
                        % Degree 10 (actually degree 11), 28 Points, PI, 
                        % Fully symmetric, Reference: [R1] see Table 1 on 
                        % page 775.
                        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                        Qn = quadSquareNonProductDegree11(varargin{:});
                end
        end
end

end%
%%
function Qn = quadSquareNonProductDegree11(varargin)
% Lower bound = 24

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 11, 24* Points, PI, Rotationally symmetric, References:
        % [C1] see Table 3 on page 144. (Note: Higher precision numerical
        % values obtained from [C3]).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = { 'R4','R4','R4','R4','R4','R4','R4'};
        Qn.m     = [ 4, 4, 4, 4, 4, 4 ];
        Qn.xi1 = [ 0.982639223540855472952491497004009,...
            0.825775835902963937302274585289940,...
            0.188586138718641954600324568182745,...
            0.812520548304813100489382581912299,...
            0.525320250364547762341631887140024,...
            0.0416580719120223682735468045377018 ];
        Qn.xi2 = [ 0.698076104549567564776469806174958,...
            0.939486382816736907206432362169896,...
            0.953539528201532015845004266823976,...
            0.315623432915254195985609716402104,...
            0.712001913075336306549065895123759,...
            0.424847248848669250615430111511957 ];
        Qn.w = [ 0.0480207633507238145627631759775806,...
            0.0660713291645505956736350808495464,...
            0.0973867773586681641961204397995472,...
            0.211736349998948600503931661356261,...
            0.225626061728863387403158016208490,...
            0.351158718398245437660391625808574 ];
    case 'full'
        switch varargin{2}
            case 'allowNegative'
                % _________________________________________________________
                % Degree 11, 25 Points, NI, Fully symmetric, References:
                % [P1] see Table 1 on page 81 (Note: Higher precision
                % numerical values obtained from [C3]).
                % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Qn.group = { 'n0','n1','n1','n2','n2','n3'};
                Qn.m     = [ 1, 4, 4, 4, 4, 8 ];
                Qn.xi1 = [ 0.000000000000000000000000000000000,...
                    0.778611025211893706189898551812090,...
                    0.129592138630874084573352854012461,...
                    0.594844815209697332509502754563689,...
                    0.886911723006977931108092495020272,...
                    0.962238285065848191535206158230963 ];
                Qn.xi2 = [ 0.000000000000000000000000000000000,...
                    0.000000000000000000000000000000000,...
                    0.000000000000000000000000000000000,...
                    0.594844815209697332509502754563689,...
                    0.886911723006977931108092495020272,...
                    0.430358680480185718677522921956173 ];
                Qn.w = [ -5.18229042763431706668374817617385,...
                    0.240752910127639684339143177678012,...
                    1.54740574681141132028747983255983,...
                    0.264229794673828263722125740536878,...
                    0.0812170871762470666168807308362978,...
                    0.0809835340597264658526537812162172 ];
                
            case 'positive'
                switch varargin{3}
                    case 'allowOutside'
                        % _________________________________________________
                        % Degree 11, 25 Points, PO (4 points outside),
                        % Fully symmetric, Reference: [R1] see Table 1 on
                        % page 775.
                        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                        Qn.group = { 'n0','n1','n1','n2','n2','n3'};
                        Qn.m     = [ 1, 4, 4, 4, 4, 8 ];
                        Qn.xi1 = [ 0.0000000000000000,...
                            0.7697990683966493,...
                            1.044402915409813,...
                            0.4134919534491139,...
                            0.9357870124405403,...
                            0.5756535958404649 ];
                        Qn.xi2 = [ 0.0000000000000000,...
                            0.0000000000000000,...
                            0.0000000000000000,...
                            0.4134919534491139,...
                            0.9357870124405403,...
                            0.8830255085256902 ];
                        Qn.w = [ 0.3653795255859022,...
                            0.2442720577517539,...
                            0.0277561655642043,...
                            0.3089930361337136,...
                            0.0342651038512293,...
                            0.1466843776513117 ];
                    case 'inside'
                        % _________________________________________________
                        % Degree 11, 28 Points, PI, Fully symmetric,
                        % Reference: [R1] see Table 1 on page 775.
                        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                        Qn.group = { 'n1','n1','n2','n2','n2','n3'};
                        Qn.m     = [ 4, 4, 4, 4, 4, 8 ];
                        Qn.xi1 = [ 0.8989737240828844,...
                            0.7632367891419969,...
                            0.8949648832822285,...
                            0.6322452037101431,...
                            0.2797353125538562,...
                            0.9602661668053869 ];
                        Qn.xi2 = [ 0.0000000000000000,...
                            0.0000000000000000,...
                            0.8949648832822285,...
                            0.6322452037101431,...
                            0.2797353125538562,...
                            0.4347413023856830 ];
                        Qn.w = [ 0.0176679598882646,...
                            0.2322248008989674,...
                            0.0715516745178401,...
                            0.2192868905662522,...
                            0.2965842326220580,...
                            0.0813422207533089 ];
                end
        end
end

end%*
%%
function Qn = quadSquareNonProductDegree12(varargin)
% Lower bound = 28

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 12, 31 Points, PI, Asymmetric, Reference: [T1] see
        % Appendix A on page 189 and Figure 2 (right) on page 187.
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m   = ones(31,1);
        Qn.xi1 = [ -3.8131119459148788e-01,...
            6.4573191109453948e-02,...
            -1.0834321329194775e-02,...
            -3.1882703020851938e-01,...
            4.9124051440092803e-01,...
            -2.0906799447670715e-01,...
            1.8948337189272124e-01,...
            -6.9740094114568829e-01,...
            -5.8402513589553640e-01,...
            4.4701377237977313e-01,...
            3.4867912208378016e-01,...
            -8.2562697914640848e-01,...
            8.2839794669248942e-02,...
            -4.0351974647584699e-01,...
            6.5401042056406233e-01,...
            -9.0264377285460362e-01,...
            -8.5295397551927077e-01,...
            8.2216786295901656e-01,...
            7.4510555770497011e-01,...
            -9.4133986362315170e-01,...
            -5.4461187387612175e-01,...
            7.4407322966908984e-01,...
            -7.2254885481492603e-01,...
            6.7524406569352735e-01,...
            9.3807676975195520e-01,...
            -9.9171408764710778e-01,...
            -9.7391149358748841e-01,...
            -9.2231295237113653e-01,...
            9.5557708019583965e-01,...
            9.8216591295043421e-01,...
            9.2557212335129857e-01 ];
        Qn.xi2 = [ -1.5398000784199919e-01,...
            -4.9794871568657245e-01,...
            1.2224478971657705e-01,...
            -7.3294898893865745e-01,...
            -7.8409257688727241e-01,...
            6.5611051497298534e-01,...
            8.9911805536738287e-01,...
            -4.2248127033807525e-01,...
            3.3100645378716304e-01,...
            -2.2659664973677845e-01,...
            4.3860404955163790e-01,...
            -7.8339223275580994e-01,...
            -9.4230798695085749e-01,...
            9.6482881096343187e-01,...
            7.3857098028675039e-01,...
            -1.5881852211379360e-02,...
            4.0163251602231481e-01,...
            -5.2660748692256265e-01,...
            1.0988549815212308e-01,...
            -9.5414148142964417e-01,...
            -9.5530036379122441e-01,...
            -9.7744835460673618e-01,...
            7.9662230649630528e-01,...
            9.9626110485909680e-01,...
            8.8729244026658205e-01,...
            -5.2853945477454323e-01,...
            5.9955340548238656e-01,...
            9.5082592343728289e-01,...
            -8.4903353418547223e-01,...
            -1.6369711363774472e-01,...
            4.7425880434330858e-01 ];
        Qn.w = [ 2.3598701292933691e-01,...
            2.4110813600847844e-01,...
            2.7048224227639595e-01,...
            1.8648166880884143e-01,...
            1.7241958393889878e-01,...
            2.4109442092821515e-01,...
            1.4125391453247216e-01,...
            1.8292025454973745e-01,...
            2.2222997581864359e-01,...
            2.4904537785770031e-01,...
            2.5112362229462498e-01,...
            9.2811359998802967e-02,...
            9.8238337173087234e-02,...
            6.8583817743889233e-02,...
            1.5506938444449642e-01,...
            1.3182320881366066e-01,...
            6.0068518355283269e-02,...
            1.5766018519773284e-01,...
            1.9930860602643424e-01,...
            2.1719109379092324e-02,...
            6.4596098758824216e-02,...
            4.0584519909105145e-02,...
            1.2603341007939087e-01,...
            3.0006912476756006e-02,...
            4.4974753329261395e-02,...
            3.8721244577288268e-02,...
            4.7718056922379071e-02,...
            3.0056189691189335e-02,...
            4.4499282846528827e-02,...
            5.6566093223890265e-02,...
            9.6814701109561335e-02 ];
    case 'full'
        switch varargin{3}
            case 'allowOutside'
                % _________________________________________________________
                % Degree 12 (actually degree 13), 36 Points, PO (8 points
                % slightly outside), Fully symmetric, Reference: [D1] see
                % Appendix I (Note: Higher precision numerical values
                % obtained from [C3]).
                % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Qn = quadSquareNonProductDegree13(varargin{:});
            case 'inside'
                % _________________________________________________________
                % Degree 12 (actually degree 13), 37 Points, PI, Fully
                % symmetric, Reference: [R1] see Table 1 on page 775.
                % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Qn = quadSquareNonProductDegree13(varargin{:});
        end
end



end%
%%
function Qn = quadSquareNonProductDegree13(varargin)
% Lower bound = 31

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 13, 33 Points, PI, Rotationally symmetric, Reference: [C1]
        % see Table 4 on page 145. (Note: Higher precision numerical values
        % obtained from [C3]).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = { 'n0','R4','R4','R4','R4','R4','R4','R4','R4'};
        Qn.m  = [ 1 4 4 4 4 4 4 4 4 ];
        Qn.xi1 = [ 0.000000000000000000000000000000000,...
            0.778809711554419422518950716200066,...
            0.957297699786307365656287624772569,...
            0.138183459862465353747201180366305,...
            0.941327225872925236949202633571536,...
            0.475808625218275905067592843403424,...
            0.755805356572081436271284634469161,...
            0.696250078491749413958995705034429,...
            0.342716556040406789413127073436852 ];
        Qn.xi2 = [ 0.000000000000000000000000000000000,...
            0.983486682439872263785464064810689,...
            0.859556005641638928585158567664368,...
            0.958925170287534857539761330199218,...
            0.390736216129461000676868009685597,...
            0.850076673699748575968765587001098,...
            0.647821637187010732043593028587847,...
            0.0707415089964449362170593518741909,...
            0.409304561694038843304552140256900 ];
        Qn.w = [ 0.300382115431225361385993144131565,...
            0.0299918388644991316656136556579163,...
            0.0381744213170836696403703749495439,...
            0.0604249238177499806808655931942460,...
            0.0774927385331053393578275533591067,...
            0.118844667300595601081799146176429,...
            0.129763550370002711285543930619763,...
            0.213341581457189389433004284180740,...
            0.256870749481967836508477175829362 ];
    case 'full'
        switch varargin{3}
            case 'allowOutside'
                % _________________________________________________________
                % Degree 13, 36 Points, PO (8 points slightly outside),
                % Fully symmetric, Reference: [D1] see Appendix I (Note:
                % Higher precision numerical values obtained from [C3]).
                % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Qn.group = {'n1','n1','n2','n2','n2','n4','n4'};
                Qn.m  = [ 4 4 4 4 4 8 8 ];
                Qn.xi1 = [ 1.08605615857397120336678905375279,...
                    0.658208197042584618351890436281098,...
                    1.00130060299172862554031908351230,...
                    0.584636168775946268451605167338590,...
                    0.246795612720261472147267074889164,...
                    0.900258815287200905764771203165205,...
                    0.929866705560779661295318863131219 ];
                Qn.xi2 = [ 0.000000000000000000000000000000000,...
                    0.000000000000000000000000000000000,...
                    1.00130060299172862554031908351230,...
                    0.584636168775946268451605167338590,...
                    0.246795612720261472147267074889164,...
                    0.304720678579870162309489405066264,...
                    0.745052720131168743418620443098460 ];
                Qn.w = [ 5.65616969376364384549830914843054e-03,...
                    0.192443867470395731546124615797723,...
                    5.16683297977296925493144364811587e-03,...
                    0.200302559622138062702448397479729,...
                    0.228125175912536058608390049910465,...
                    0.117496926974491417484639244557150,...
                    0.0666557701862053495366643474506171 ];
            case 'inside'
                % _________________________________________________________
                % Degree 13, 37 Points, PI, Fully symmetric,
                % Reference: [R1] see Table 1 on page 775. (Note:
                % Higher-precision numerical values obtained from online
                % material of [W2])
                % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                Qn.group = {'n0','n1','n1','n2','n2','n2','n3','n3'};
                Qn.m  = [ 1 4 4 4 4 4 8 8 ];
                Qn.xi1 = [ 0.00000000000000000000000000000000000000,...
                    0.98346133261324557127407851401210794962,...
                    0.63986141836710976174616715579576307077,...
                    0.91877848807971140189839438297320428483,...
                    0.37962850518674385579275417103548349005,...
                    0.69955421651335111029920603284399340644,...
                    0.64359737499661812031249815775600267943,...
                    0.33353988116478310285167199804895857823 ];
                Qn.xi2 = [ 0.00000000000000000000000000000000000000,...
                    0.00000000000000000000000000000000000000,...
                    0.00000000000000000000000000000000000000,...
                    0.91877848807971140189839438297320428483,...
                    0.37962850518674385579275417103548349005,...
                    0.69955421651335111029920603284399340644,...
                    0.97506888390598351993655206803811094573,...
                    0.86442760926706191157507267741750728791 ];
                Qn.w = [ 0.29999334435890964324064310267149902525,...
                    0.038128625349852737619351565405684462236,...
                    0.18453546896980721238582475319389847126,...
                    0.039507140647452433689267407341729599229,...
                    0.23139851940068538741918311064046319298,...
                    0.13724209671300348677866127359579016247,...
                    0.033519780050381430279388297868080126418,...
                    0.11357512636435423536938725920919955133,...
                    0.1169047000557597 ];
        end
end

end%
%%
function Qn = quadSquareNonProductDegree14(varargin)
% Lower bound = 36

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 14, 40 Points, PI, Asymmetric, Reference: [X1] reported in
        % Table 3 on page 672 (numerical values obtained from their online
        % supplmental material of [F1]).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m = ones(40,1);
        Qn.xi1 = [ 0.978424724809163,...
            0.969603336712839,...
            0.963590790043370,...
            0.960968085368934,...
            0.875917524482432,...
            0.985062297786155,...
            0.913237816426300,...
            0.821025557525128,...
            0.725380269764677,...
            0.712997223461731,...
            0.555178198454430,...
            0.804762794651635,...
            0.642437318343902,...
            0.420262058803690,...
            0.454716661547081,...
            0.425999014359916,...
            0.097100210279545,...
            0.111400891949802,...
            0.120966713075827,...
            0.075240974000709,...
            -0.451865619643839,...
            -0.204027157538049,...
            -0.242786221887462,...
            -0.245978258574106,...
            0.212485245072298,...
            -0.756810823938178,...
            -0.544820269311466,...
            -0.590838572376248,...
            -0.289504630271099,...
            -0.641703677752636,...
            -0.792159515081385,...
            -0.952731301655972,...
            -0.830091248861022,...
            -0.575883905554012,...
            -0.795488018758195,...
            -0.956200751487269,...
            -0.983987652325970,...
            -0.855251804294419,...
            -0.969459172377857,...
            -0.946828297536782 ];
        Qn.xi2 = [ 0.984937903734568,...
            -0.333163335235832,...
            -0.823513582769619,...
            -0.966584805420939,...
            0.844051901697555,...
            0.592700688227278,...
            0.168664410744605,...
            -0.631213848411480,...
            0.527129942425108,...
            -0.174672536420665,...
            -0.861767756949510,...
            -0.967443278637930,...
            0.966000873716132,...
            0.780959611688725,...
            0.192740171757690,...
            -0.496220871576863,...
            0.953697708245357,...
            0.492361628989690,...
            -0.150346910087625,...
            -0.745225320681073,...
            0.942779571658229,...
            0.759122403141817,...
            0.173670882503247,...
            -0.444995593692259,...
            -0.981073283324293,...
            0.790112231557005,...
            0.503432454884012,...
            -0.126893586711081,...
            -0.911613391194910,...
            -0.988671556125608,...
            0.995532251856557,...
            0.568824328455025,...
            0.226202963079457,...
            -0.675636601556392,...
            -0.850668486940865,...
            0.913990677793497,...
            -0.053815972687165,...
            -0.400202838094425,...
            -0.682355699283399,...
            -0.950625511390845 ];
        Qn.w = [ 0.007042609290975,...
            0.051270004016192,...
            0.028359041168349,...
            0.005802552341291,...
            0.064068397997811,...
            0.030598274531836,...
            0.101529330417783,...
            0.107056679219658,...
            0.149185020168265,...
            0.167267472961324,...
            0.103516624872879,...
            0.027870081382692,...
            0.042657042724924,...
            0.142507546670328,...
            0.210551616279166,...
            0.186718517291814,...
            0.069721824425892,...
            0.204394861831303,...
            0.233593053928049,...
            0.160126902666834,...
            0.064652708342861,...
            0.146692922136524,...
            0.228028187107388,...
            0.205527257703408,...
            0.043167692319290,...
            0.095767216693032,...
            0.173931517149367,...
            0.194149002429771,...
            0.096633451996032,...
            0.022663312686611,...
            0.013933823168936,...
            0.056576033796633,...
            0.132722344887894,...
            0.136948174137299,...
            0.060333219128621,...
            0.024195465814254,...
            0.041161105450212,...
            0.116417817426335,...
            0.034727562538021,...
            0.017933730900148 ];
    case 'full'
        if strcmp(varargin{2},'allowNegative') && ...
                strcmp(varargin{3},'allowOutside')
            % _____________________________________________________________
            % Degree 14 (actually 15), 45 Points, NO (4 points slightly 
            % outside, 1 negative weight), Fully symmetric, Reference: [D1] 
            % see Appendix I (Note: Higher precision numerical values 
            % obtained from [C3]).
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
            Qn = quadSquareNonProductDegree15(varargin{:});            
        else
            % _____________________________________________________________
            % Degree 14 (actually 15), 48 Points, PI,  Fully symmetric, 
            % Reference: [W2] reported as new in Table 1 on page 1240 
            % (numerical values obtained from their online supplemental 
            % material). (Note: [R1] reports an earlier rule with the same 
            % number of points and quality that uses different orbits.)
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯           
            Qn = quadSquareNonProductDegree15(varargin{:});   
        end            
end

end%
%%
function Qn = quadSquareNonProductDegree15(varargin)
% Lower bound = 36

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 15, 44 Points, PI, Rotationally symmetric, Reference: [C1]
        % see Table 4 on page 145. (Note: Higher precision numerical values
        % obtained from [C3]).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = {'R4','R4','R4','R4','R4','R4','R4','R4','R4','R4','R4'};
        Qn.m = [ 4 4 4 4 4 4 4 4 4 4 4 ];
        Qn.xi1 = [ 0.98798456650771809034922121236542,...
            0.90815949600657000212015099547736,...
            0.67928365833453304991325391003325,...
            0.50911373411758353514778637359508,...
            0.97675332466910190352385200798077,...
            0.75619936719149244012005066365912,...
            0.89778569328633877480008574782677,...
            0.20599307074252141729418963873618,...
            0.45144312511299139017533875886564,...
            0.66683824538360873834071399129626,...
            0.74295704755765822553432311307323e-1 ];
        Qn.xi2 = [ 0.77126821223875533899886933446485,...
            0.95703183434690690872237176442598,...
            0.88260197593087253601344445274335,...
            0.97120312974183699854692313856226,...
            0.83559862608781647288448365846813e-1,...
            0.75619936719149244012005066365912,...
            0.46676265923796434848237353795400,...
            0.84079448454078540426562160968883,...
            0.56245686233219940637540066298377,...
            0.19046630243571720761679616635243,...
            0.32397702249753019818251854432752 ];
        Qn.w = [ 0.20881470204497523521771058289754e-1,...
            0.25545901574497276542640153395248e-1,...
            0.31203866624933300871149690867662e-1,...
            0.38010761595074827467645518285610e-1,...
            0.41449061852426148002787373214871e-1,...
            0.79320407004083334044710201039891e-1,...
            0.88901265758751523303980720079987e-1,...
            0.12016982158206027507823569713056,...
            0.16882043410639799754153511014621,...
            0.16987162497336185160489786440053,...
            0.21582538472391594202064661314968 ];
    case 'full'
        if strcmp(varargin{2},'allowNegative') && ...
                strcmp(varargin{3},'allowOutside')
            % _____________________________________________________________
            % Degree 15, 45 Points, NO (4 points slightly outside, 1
            % negative weight), Fully symmetric, Reference: [D1] see
            % Appendix I (Note: Higher precision numerical values obtained
            % from [C3]).
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            Qn.group = { 'n0','n1','n1','n1','n2','n2','n3','n3','n3'};
            Qn.m = [ 1 4 4 4 4 4 8 8 8 ];
            Qn.xi1 = [ 0.00000000000000000000000000000000,...
                1.02731435771936715907904129504282,...
                0.856766776147642981461258910067062,...
                0.327332998189722756037548291745317,...
                0.967223740028505208852290546784051,...
                0.732168901749710784373133343428783,...
                0.621974427996804674190653240174775,...
                0.928618480068351524547627152235259,...
                0.960457474887516426055756497071001 ];
            Qn.xi2 = [ 0.00000000000000000000000000000000,...
                0.00000000000000000000000000000000,...
                0.00000000000000000000000000000000,...
                0.00000000000000000000000000000000,...
                0.967223740028505208852290546784051,...
                0.732168901749710784373133343428783,...
                0.321696694921008998506658258126833,...
                0.455124178121178913760146891883157,...
                0.809863684081217393737230579811965 ];
            Qn.w = [ -1.76897982720743509193343825298927e-3,...
                0.0128167266175116469960171365668017,...
                0.119897873101346794785777173401566,...
                0.210885452208800668009415831424386,...
                6.39272012821519232808307330633727e-3,...
                0.104415680788579877755836145577680,...
                0.168053047203815822883579428916449,...
                0.0761696944522944784011072197237691,...
                0.0287941544000635381642403510030187 ];
        else
            % _____________________________________________________________
            % Degree 15, 48 Points, PI,  Fully symmetric, Reference: [W2] 
            % reported as new in Table 1 on page 1240 (numerical values
            % obtained from their online supplemental material). 
            % (Note: [R1] reports an earlier rule with the same number of
            % points and quality that uses different orbits.)
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
            Qn.group = { 'n1','n1','n2','n2','n3','n3','n3','n3'};
            Qn.m = [ 4 4 4 4 8 8 8 8 ];
            Qn.xi1 = [ 0.79809898789700709024555173503596148462,...                                           ,...
                0.30385302639845975610268178690962703058,...
                0.88242227010688535992041188667767184542,...
                0.97778979953990269742424689352375866785,...
                0.80871213581950356724002823901416977471,...
                0.30465479903705254117098598695333881061,...
                0.9805048437245319615400269877302555585,...
                0.26484415587231617710014274826830856062 ];
            Qn.xi2 = [ 0.00000000000000000000000000000000000000,...
                0.00000000000000000000000000000000000000,...
                0.88242227010688535992041188667767184542,...
                0.97778979953990269742424689352375866785,...
                0.56721357339659070317865169083903012406,...
                0.57873619403580651026013939264701051891,...
                0.6974636319909670187938904551822360596,...
                0.95574251980951170852387507604700262081 ];
            Qn.w = [ 0.11493292726352536781596028932541766228,...
                0.18168575896727184957040458577073367484,...
                0.041238483788765811839027639617216599853,...
                0.0059337464858392213147614197893498681047,...
                0.10114914347743242280761079470300175928,...
                0.14783672163288121847905618360636339726,...
                0.023273194144673214602574891933463059923,...
                0.055845482492312018840681162505812880996 ];
        end
end

end%
%%
function Qn = quadSquareNonProductDegree16(varargin)
% Lower bound = 45

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 16, 52 Points, PI, Asymmetric, Reference: [X1] reported in
        % Table 3 on page 672 (numerical values obtained from their online
        % supplmental material).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m = ones(52,1);
        Qn.xi1 = [ 0.4455077315117610,...
            -0.2848639978436560,...
            0.3281612731066610,...
            0.8918323090897290,...
            0.5080739455207710,...
            -0.1604014838336730,...
            -0.5084786013975690,...
            0.6830501661618820,...
            0.0395860907854577,...
            -0.9505884228486960,...
            -0.9618117119546930,...
            -0.9824876605856200,...
            0.7294909884375440,...
            0.1663512176814140,...
            -0.8401346406026950,...
            0.7196828159773350,...
            0.2530272226250720,...
            0.0640312855857471,...
            0.9867649245062880,...
            -0.2009570267598740,...
            -0.4385685045405640,...
            0.9942720499027970,...
            -0.8306577686854560,...
            0.1540093368841130,...
            0.5127230397362320,...
            -0.9896697019211780,...
            0.9721677355950010,...
            -0.7432189863550820,...
            0.7845206176595360,...
            0.9792382924978340,...
            -0.7071472873150690,...
            -0.1416891896032320,...
            0.8901118844470470,...
            0.8991291622644930,...
            -0.8948787586840300,...
            -0.1685236423690620,...
            0.8814614259143860,...
            -0.9727794481100780,...
            -0.2335640652756550,...
            0.9317484014546710,...
            0.4462548323794500,...
            -0.4956609448877940,...
            -0.7464462325957710,...
            -0.6209288757442600,...
            -0.9729904625306640,...
            0.6851689211463190,...
            -0.6950237982778370,...
            0.1406973647399050,...
            -0.8903519744155600,...
            -0.4494459013630720,...
            0.6393855383975150,...
            0.4185604687784280 ];
        Qn.xi2 = [ -0.4133544718603060,...
            -0.7739045957079850,...
            -0.9418618376442870,...
            -0.5606355473579230,...
            0.9698717423735350,...
            -0.4892197731244820,...
            -0.9117050044897800,...
            -0.5146278686624720,...
            -0.8810600362311170,...
            -0.9545711191201150,...
            -0.5466258413042110,...
            -0.8038321990753310,...
            -0.1738438525238660,...
            -0.6521123405187270,...
            -0.3199762775663760,...
            0.8583352444264190,...
            0.9559713160961980,...
            0.8638442022353130,...
            -0.7782646945578280,...
            0.6577321912732580,...
            -0.2429524974731520,...
            0.3876054361677950,...
            -0.7951217128043850,...
            -0.2163105603296340,...
            -0.7522598930908060,...
            0.5914422527084510,...
            -0.2390927720573680,...
            -0.9749994483165600,...
            -0.8444622014821820,...
            0.8810775159513400,...
            0.6173187727164630,...
            0.0729232465212486,...
            0.1389731666217060,...
            0.6539121663076460,...
            0.8152409648202000,...
            -0.9939582277051610,...
            0.9818676808679300,...
            0.9582010007957960,...
            0.9824162852107250,...
            -0.9611203598796460,...
            0.1014796681115950,...
            0.8630083224142980,...
            0.9693553936129730,...
            -0.5969027498090260,...
            -0.0378988032541919,...
            0.4272704958652740,...
            0.0431330285758484,...
            0.4101941952194760,...
            0.3277950128817070,...
            0.3540266909627900,...
            -0.9786311482371550,...
            0.6960968466161750 ];
        Qn.w = [ 0.1097508957721360,...
            0.0927354226337059,...
            0.0493914845803149,...
            0.0693303317774097,...
            0.0292994023864900,...
            0.1366632972432510,...
            0.0604636878778000,...
            0.0601231965638861,...
            0.0652537104113575,...
            0.0142666466939455,...
            0.0367399852273396,...
            0.0102444500900469,...
            0.1228913099966440,...
            0.1098941997269090,...
            0.0965170453652472,...
            0.0699026078894992,...
            0.0274265904927372,...
            0.0889210016527648,...
            0.0173758967480239,...
            0.1456519315667650,...
            0.1596717621222830,...
            0.0207796654359393,...
            0.0626647009936280,...
            0.1673174744263060,...
            0.0898814960047095,...
            0.0216035580221650,...
            0.0401810489158842,...
            0.0208233339075203,...
            0.0583944867242044,...
            0.0162528920031980,...
            0.1114842052111100,...
            0.1894661576875590,...
            0.0879055849264569,...
            0.0670642559456137,...
            0.0499256686791249,...
            0.0235281311237585,...
            0.0151972447812462,...
            0.0098210240469027,...
            0.0325093076697077,...
            0.0174068569050301,...
            0.1792979282168250,...
            0.0890333334382223,...
            0.0292186158317671,...
            0.1223721596688210,...
            0.0415564804446345,...
            0.1357709578952650,...
            0.1360842630489210,...
            0.1850218619823140,...
            0.0864843018802391,...
            0.1618376846285260,...
            0.0230268995999515,...
            0.1355735631358920 ];
    case 'full'
        if strcmp(varargin{2},'allowNegative') && ...
                strcmp(varargin{3},'allowOutside')
            % _____________________________________________________________
            % Degree 16 (actually 17), 57 Points, NO (4 points outside and 
            % 5 negative weights, Fully symmetric, Reference: [C2] see 
            % formula C_2(17-2) on page 50. (Note: Higher precision 
            % numerical values obtained from [C3]).
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯            
            Qn = quadSquareNonProductDegree17(varargin{:});
        else
            % _____________________________________________________________
            % Degree 16 (actually 17), 60 Points, PI,  Fully symmetric, 
            % Reference: [D1] see Appendix I (Note: Higher precision 
            % numerical values obtained from [C3]).
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯            
            Qn = quadSquareNonProductDegree17(varargin{:});
        end
end

end%
%%
function Qn = quadSquareNonProductDegree17(varargin)
% Lower bound = 49

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 17, 54 Points, PI, Rotationally symmetric, Reference: [F1]
        % reported as new in Table 1 on page 4301 (numerical values
        % obtained from their online supplmental material).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m = ones(54,1);
        Qn.xi1 = [ -9.863407162001064e-01,...
            -9.797917920771685e-01,...
            -9.759748695590249e-01,...
            -9.751604610540874e-01,...
            -9.655463590660567e-01,...
            -9.580417051272648e-01,...
            -8.990410418369936e-01,...
            -8.929777462525665e-01,...
            -8.684155248367631e-01,...
            -8.543834155553983e-01,...
            -8.198994002699886e-01,...
            -7.927874398654909e-01,...
            -7.313489231885142e-01,...
            -7.090784726108733e-01,...
            -6.903443278598889e-01,...
            -6.159136297254387e-01,...
            -5.503655196818333e-01,...
            -5.088888961572688e-01,...
            -4.701395263110675e-01,...
            -3.956137656607415e-01,...
            -3.787399827823459e-01,...
            -2.831429683388207e-01,...
            -2.468625326731463e-01,...
            -2.225539938942038e-01,...
            -1.626641413140420e-01,...
            -6.874965210282233e-02,...
            -5.847903009448556e-02];
        Qn.xi2 = [ -5.350413962053188e-01,...
             9.250929106098536e-02,...
            -9.216725954273451e-01,...
             8.226615823534071e-01,...
             5.873038194012039e-01,...
             9.392146008421756e-01,...
            -2.442899840300571e-01,...
            -7.628113086068719e-01,...
            -9.940332573157988e-01,...
             3.348609125819369e-01,...
             7.861039744617548e-01,...
             9.867131971602722e-01,...
            -5.375736491397500e-01,...
            -9.201347632293920e-01,...
             8.463704695540367e-03,...
             5.598744500532884e-01,...
             9.111946838818689e-01,...
            -7.826367523208496e-01,...
            -3.185012886935781e-01,...
             2.488545706442738e-01,...
            -9.766193765657439e-01,...
             7.382031830574145e-01,...
            -6.309764352559230e-01,...
             9.838126768040562e-01,...
            -1.008646063203129e-01,...
            -8.853346747431012e-01,...
             4.510735833781594e-01 ];
        Qn.w = [ 2.305601467067279e-02,...
            3.240673241115238e-02,...
            1.270290274356204e-02,...
            6.967658416756498e-03,...
            3.379494459982002e-02,...
            1.490471492599059e-02,...
            8.052033202871829e-02,...
            5.184525239733102e-02,...
            8.888523934900541e-03,...
            8.942431131283363e-02,...
            6.602369125585303e-02,...
            1.519282623398942e-02,...
            1.043702032541429e-01,...
            4.542324896856204e-02,...
            1.345081852973794e-01,...
            1.235292068763380e-01,...
            6.486019261315923e-02,...
            8.485070415264370e-02,...
            1.454492206755823e-01,...
            1.612339647041861e-01,...
            3.251051105156653e-02,...
            1.224068303196167e-01,...
            1.169672902517008e-01,...
            2.855916848841619e-02,...
            1.626132038726945e-01,...
            8.682936644584309e-02,...
            1.501607980965882e-01 ];
        Qn.xi1(28:54) = -Qn.xi1(1:27);
        Qn.xi2(28:54) = -Qn.xi2(1:27);
        Qn.w(28:54)   = Qn.w(1:27);        
    case 'full'
        if strcmp(varargin{2},'allowNegative') && ...
                strcmp(varargin{3},'allowOutside')
            % _____________________________________________________________
            % Degree 17, 57 Points, NO (4 points outside and 5 negative 
            % weights, Fully symmetric, Reference: [C2] see formula 
            % C_2(17-2) on page 50. (Note: Higher precision numerical 
            % values obtained from [C3]).
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            Qn.group = {'n0','n1','n1','n1','n1','n2','n2','n3','n3',...
                'n3','n3'};
            Qn.m = [ 1 4 4 4 4 4 4 8 8 8 8 ];
            Qn.xi1 = [ 0.000000000000000000000000000000000,...
                0.306312167965201480477494377771843,...
                0.805577523568691493998753743961445,...
                0.995565063481266781943917958963776,...
                1.15099365445072296796673025544312,...
                0.883340205930009423568851248892825,...
                0.977595952140367219026824181737472,...
                0.305517680071780140623426488439646,...
                0.341300475378862982654976557731168,...
                0.592075027733856898443150567571310,...
                0.703071197728503895822288389001383 ];
            Qn.xi2 = [ 0.000000000000000000000000000000000,...
                0.000000000000000000000000000000000,...
                0.000000000000000000000000000000000,...
                0.000000000000000000000000000000000,...
                0.000000000000000000000000000000000,...
                0.883340205930009423568851248892825,...
                0.977595952140367219026824181737472,...
                0.583505836600355689822143755467241,...
                0.934841290567952449951221624725044,...
                0.795229150385196624202135623460416,...
                0.980797640771394939643646501344975 ];
            Qn.w = [ -1.46822428275165074566364922115246e-4,...
                0.184553602503439738162511798658818,...
                0.114892212618866386380986412403501,...
                0.0181829379838754933678752482384304,...
               -2.43482420546464881380520951686203e-5,...
                0.0401722135913555948765349014830975,...
                5.87544864835012605338938297645262e-3,...
                0.150146403680207482615118644903017,...
                0.0593024499345109549154348965151619,...
                0.0861794023404334444338290156091504,...
                0.0225640632964661674933583927553691 ];
        else
            % _____________________________________________________________
            % Degree 17, 60 Points, PI,  Fully symmetric, Reference: [D1] 
            % see Appendix I (Note: Higher precision numerical values 
            % obtained from [C3]).
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
            Qn.group = {'n1','n1','n2','n2','n2','n3','n3','n3','n3','n3'};
            Qn.m = [ 4 4 4 4 4 8 8 8 8 8 ];
            Qn.xi1 = [ 0.989353074512600491226435837616855,...
                0.376285207157973294407548611720249,...
                0.978848279262233116070071435993900,...
                0.885794729164116128906454358065004,...
                0.171756123838348174694383891493585,...
                0.590499273806002413351516521008016,...
                0.799079131916863255810133334567146,...
                0.803743962958744711785449825494367,...
                0.936506276127494781742088348171630,...
                0.981321179805452294975910440430711 ];
            Qn.xi2 = [ 0.000000000000000000000000000000000,...
                0.000000000000000000000000000000000,...
                0.978848279262233116070071435993900,...
                0.885794729164116128906454358065004,...
                0.171756123838348174694383891493585,...
                0.319505036634573945676789474303272,...
                0.597972451929457380262801755996745,...
                0.0583444817765505296843531563292007,...
                0.347386316166202674785997791701337,...
                0.706000287798646119181926220623163 ];
            Qn.w = [ 0.0206149159199909598849346111352593,...
                0.128025716179909834718790578266771,...
                5.51173953403189052015467719393391e-3,...
                0.0392077124571418804955998450600411,...
                0.0763969450798633024005048543017064,...
                0.141513729949972459244609749412573,...
                0.0839032793637976020823276661920304,...
                0.0603941636496845460309035890917432,...
                0.0573877529692126951214158298337486,...
                0.0219225594818637635107508824910476 ];
        end
end

end%
%%
function Qn = quadSquareNonProductDegree18(varargin)
% Lower bound = 55

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 18, 64 Points, PI, Asymmetric, Reference: [X1] reported in
        % Table 3 on page 672 (numerical values obtained from their online
        % supplmental material).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m = ones(64,1);
        Qn.xi1 = [ -0.982429297281976,...
           -0.980380015083047,...
            0.978687397095401,...
            0.978306471706846,...
            0.972103651465078,...
            0.593429919248951,...
            0.597634101219749,...
           -0.369296188601143,...
            0.704947905579518,...
           -0.737346800800434,...
            0.986198906466038,...
           -0.084651582098743,...
            0.885013997448202,...
           -0.931392615028487,...
           -0.708998195731981,...
            0.873261409217360,...
           -0.841939921562292,...
            0.322427946202819,...
            0.224464012452270,...
           -0.834718000493207,...
           -0.827953630478414,...
           -0.656812538100131,...
           -0.846004296423096,...
           -0.924217429470285,...
           -0.541436884489989,...
            0.926530484170683,...
           -0.898115617304339,...
           -0.411573212027107,...
            0.604745362251865,...
           -0.598390083509816,...
            0.432039779064828,...
            0.449966723415257,...
            0.951376456460360,...
           -0.679597970094767,...
           -0.656465211852405,...
            0.837804785251729,...
           -0.111355677239086,...
           -0.360874696271080,...
            0.986275390417332,...
           -0.233191897888659,...
           -0.987049222797420,...
           -0.989416085475088,...
           -0.983650223879544,...
            0.800243244261134,...
            0.649240423985067,...
            0.870116072569920,...
            0.738932138510633,...
           -0.471585503056962,...
            0.743616535820214,...
            0.353483468476925,...
           -0.365084945207516,...
           -0.228350620871312,...
            0.174027410246761,...
            0.899583978350057,...
            0.340592565502600,...
            0.042953287922524,...
            0.144865301606391,...
           -0.131282782124110,...
            0.500463829568670,...
            0.060066092592200,...
            0.155225723288537,...
           -0.939586463235499,...
           -0.479150775895990,...
           -0.813790239732564 ];
        Qn.xi2 = [ -0.949230454013695,...
            0.946960902613153,...
            0.762218621925671,...
           -0.919698374876273,...
            0.976418347003238,...
           -0.961646672052616,...
            0.834358971111738,...
            0.980003693855253,...
            0.987074733006691,...
           -0.833346048241696,...
           -0.327873774089739,...
            0.890846684308923,...
           -0.985580362683215,...
           -0.821284513547405,...
            0.682214391217305,...
            0.903114876131973,...
            0.988578670736746,...
            0.053651543933952,...
            0.735043760027014,...
            0.508460910847037,...
           -0.613231512811576,...
            0.229078070335027,...
           -0.978641815587595,...
           -0.310257784576101,...
           -0.627509839174689,...
            0.014074835774002,...
            0.829568002296710,...
            0.775319650278541,...
           -0.652631659900920,...
           -0.933367462258878,...
            0.924343278338674,...
            0.070056469899357,...
           -0.692596950625775,...
           -0.364194575899887,...
            0.919366501804594,...
           -0.463991552565487,...
           -0.904193692071085,...
           -0.780886581875026,...
            0.297446798275278,...
           -0.434374605151552,...
           -0.589832299076628,...
           -0.016043833664558,...
            0.639347783923839,...
           -0.848162973199419,...
           -0.205450771719314,...
           -0.101735576456372,...
            0.715956827979010,...
           -0.124581708848908,...
            0.254253207680442,...
           -0.841519989806880,...
           -0.989721938369978,...
            0.155638454565645,...
           -0.979107432403170,...
            0.529526741134148,...
           -0.416539106933105,...
           -0.150980236568746,...
            0.334737666273856,...
            0.575950475129961,...
            0.508698598301963,...
           -0.666195176990418,...
            0.984726449650269,...
            0.300334253456424,...
            0.449232669783580,...
           -0.006261874651131 ];
        Qn.w = [ 0.006901620813204,...
            0.008204870814717,...
            0.019278596336483,...
            0.010969327077447,...
            0.006009552531394,...
            0.034637323795903,...
            0.038907120558781,...
            0.026378796938874,...
            0.016416586385975,...
            0.041145861713738,...
            0.022825540585567,...
            0.073103135101909,...
            0.010449045745085,...
            0.028591162230098,...
            0.065563219850279,...
            0.032746370301029,...
            0.011052740997421,...
            0.053304519431587,...
            0.111454315838592,...
            0.056410943648424,...
            0.057697163188088,...
            0.093984010825692,...
            0.015168101019882,...
            0.054707804999564,...
            0.078099963413585,...
            0.046018476274623,...
            0.038928835116846,...
            0.086519386166870,...
            0.101381855266143,...
            0.037058378130402,...
            0.047980615285733,...
            0.105475282654229,...
            0.035049058915164,...
            0.091181315541955,...
            0.046451973042803,...
            0.075926009285387,...
            0.064283617076494,...
            0.076325340231549,...
            0.021492114487638,...
            0.145899258412579,...
            0.017414852375782,...
            0.019087391986355,...
            0.019733044490482,...
            0.053086763935161,...
            0.116789037510445,...
            0.035201523921066,...
            0.064296573796208,...
            0.133675188464838,...
            0.110904939025308,...
            0.083112287466241,...
            0.017663540854227,...
            0.153997017629200,...
            0.027596486130759,...
            0.059105433701516,...
            0.146126955531040,...
            0.164383243522767,...
            0.144789829840957,...
            0.124514097254645,...
            0.126014121327926,...
            0.125502053787605,...
            0.022665912773319,...
            0.047781667991277,...
            0.107412813357198,...
            0.085166013293940 ];
    case 'full'
        if strcmp(varargin{2},'allowNegative') && ...
                strcmp(varargin{3},'allowOutside')
            % _____________________________________________________________
            % Degree 18 (actually 19), 68 Points, NO (8 points outside and 
            % 8 negative weights, Fully symmetric, Reference: [V1] see
            % Table on page 5.
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯          
            Qn = quadSquareNonProductDegree19(varargin{:});
        else
            % _____________________________________________________________
            % Degree 18 (actually 19), 72 Points, PI,  Fully symmetric, 
            % Reference: [W2] reported as new in Table 1 on page 1240 
            % (numerical values obtained from their online supplemental 
            % material.)
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯             
            Qn = quadSquareNonProductDegree19(varargin{:});
        end      
end

end%
%%
function Qn = quadSquareNonProductDegree19(varargin)
% Lower bound = 60

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 19, 67 Points, PI, Rotationally symmetric, Reference: [F1]
        % reported as new in Table 1 on page 4301 (numerical values
        % obtained from their online supplmental material).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.m = ones(67,1);
        Qn.xi1 = [ -9.882811207043626e-01,...
            -9.849643667633750e-01,...
            -9.813999666122014e-01,...
            -9.782104202505005e-01,...
            -9.691016249998836e-01,...
            -9.683241755943918e-01,...
            -9.202706700587867e-01,...
            -9.094971072531579e-01,...
            -8.955283373897494e-01,...
            -8.910382534296201e-01,...
            -8.645217306506207e-01,...
            -8.361991822628865e-01,...
            -7.730414957980034e-01,...
            -7.650572339362595e-01,...
            -7.339165122981658e-01,...
            -7.142591688630336e-01,...
            -6.567593878397442e-01,...
            -5.911965681070577e-01,...
            -5.650612797733545e-01,...
            -5.522558344482561e-01,...
            -5.204497226646213e-01,...
            -4.843104169217222e-01,...
            -4.576710954771651e-01,...
            -3.501819505299977e-01,...
            -3.449909757079617e-01,...
            -3.245616103968320e-01,...
            -2.899888936344285e-01,...
            -2.124604121926062e-01,...
            -2.101863370194021e-01,...
            -2.061044019817992e-01,...
            -6.183281639699825e-02,...
            -5.624698000526564e-02,...
            -4.730013829225772e-02,...
            0.000000000000000e+00 ];
        Qn.xi2 = [ 5.499680659586386e-02,...
             6.212597907298936e-01,...
            -4.952365265213790e-01,...
             9.275801424350509e-01,...
            -9.857365066859964e-01,...
            -8.352830082748723e-01,...
             3.511851149995373e-01,...
            -2.172757421209814e-01,...
             7.976174402318889e-01,...
             9.945369448321910e-01,...
            -6.631996105098346e-01,...
            -9.403589726574770e-01,...
             8.238831136924889e-02,...
             5.862972313979000e-01,...
             9.301444324799357e-01,...
            -4.144687459254282e-01,...
            -8.187456800244232e-01,...
            -9.890895416891479e-01,...
             3.562777186069158e-01,...
             7.877180001548971e-01,...
            -1.319110721429938e-01,...
            -6.372481900547796e-01,...
             9.804344277407575e-01,...
            -9.155258592028724e-01,...
            -5.171112886647338e-01,...
             6.112729098917052e-01,...
             1.640917354232377e-01,...
             8.907682205113933e-01,...
            -2.888406804953518e-01,...
            -7.806540187071476e-01,...
             4.515274811396188e-01,...
            -7.388749473949220e-01,...
            -9.811237074398366e-01,...
             0.000000000000000e+00 ];
        Qn.w = [  2.092785503234627e-02,...
            1.808240699704512e-02,...
            2.248743945205191e-02,...
            1.011830773881234e-02,...
            4.619328461670566e-03,...
            1.956137669036511e-02,...
            5.773555533944277e-02,...
            6.345799736852624e-02,...
            3.990477349231469e-02,...
            6.887461729231832e-03,...
            5.773686209899585e-02,...
            2.822764839262689e-02,...
            1.001138265151715e-01,...
            7.938451847571938e-02,...
            3.698855138726674e-02,...
            9.862108370826694e-02,...
            6.430400825705974e-02,...
            1.619432554055879e-02,...
            1.145600986645687e-01,...
            7.542302799441891e-02,...
            1.271745083852966e-01,...
            7.509621769261574e-02,...
            2.360353464684936e-02,...
            5.647374387294429e-02,...
            6.683630505556533e-02,...
            1.024013654183961e-01,...
            1.271636872050067e-01,...
            6.854209870863227e-02,...
            1.103357066015591e-01,...
            3.167739924216664e-02,...
            1.060858442601201e-01,...
            8.327955875718944e-02,...
            2.608831452074966e-02,...
            1.198105245928960e-01 ];
        Qn.xi1(35:67) = -Qn.xi1(1:33);
        Qn.xi2(35:67) = -Qn.xi2(1:33);
        Qn.w(35:67)   = Qn.w(1:33);
    case 'full'
        if strcmp(varargin{2},'allowNegative') && ...
                strcmp(varargin{3},'allowOutside')
            % _____________________________________________________________
            % Degree 19, 68 Points, NO (8 points outside and 
            % 8 negative weights, Fully symmetric, Reference: [V1] see
            % Table on page 5.
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
            Qn.group = {'n1','n1','n1','n1','n2','n2','n2','n2','n2',...
                'n3','n3','n3','n3'};
            Qn.m = [ 4 4 4 4 4 4 4 4 4 8 8 8 8 ];
            Qn.xi1 = [ 0.53773332326298018133597,...
                0.90653924922283748322059,...
                1.01969524394940073586532,...
                1.47102506322866004258443,...
                0.18220897753013692257223,...
                0.42921868958705492540120,...
                0.65955676583897512677013,...
                0.83875634206737434417047,...
                0.95567112946189939463735,...
                0.75241387594728864992182,...
                0.99017838258905376567332,...
                0.90852424077312451116624,...
                0.98420260000317548568944 ];
            Qn.xi2 = [ 0.00000000000000000000000,...
                0.00000000000000000000000,...
                0.00000000000000000000000,...
                0.00000000000000000000000,...
                0.18220897753013692257223,...
                0.42921868958705492540120,...
                0.65955676583897512677013,...
                0.83875634206737434417047,...
                0.95567112946189939463735,...
                0.27931091816189475362914,...
                0.25946332544003059464706,...
                0.53042908200104190702291,...
                0.75212361546008345806570 ];
            Qn.w = [ 0.13578434707969596598465,...
                0.06703096161569812890319,...
               -0.00210170044074638175030,...
               -0.00124343131377367703879e-5,...
                0.13024271690445940817320,...
                0.12640612683233230317906,...
                0.09006775691734391433324,...
                0.04632868723461378730326,...
                0.01297135144947698554971,...
                0.10174115681794858013147,...
                0.02135167491856860097934,...
                0.05783198650690478551035,...
                0.01571006417729754640921 ];
        else
            % _____________________________________________________________
            % Degree 19, 72 Points, PI,  Fully symmetric, Reference: [W2] 
            % reported as new in Table 1 on page 1240 (numerical values
            % obtained from their online supplemental material.)
            % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   
            Qn.group = {'n1','n1','n1','n2','n2','n2',...
                'n3','n3','n3','n3','n3','n3'};
            Qn.m = [ 4 4 4 4 4 4 8 8 8 8 8 8 ];
            Qn.xi1 = [ 0.71434425957279423719800751930789820023,...
                0.26567205212096375634521276949089468244,...
                0.9644342692579672514758983345396097952,...
                0.80337972946768500184569945317555062404,...
                0.99216540589713472189744527407633022081,...
                0.92944960279960938592453972561789815525,...
                0.51027825736934335058280520856084337461,...
                0.39073420577524975124346417118562879486,...
                0.71716792130974519606308556126612093997,...
                0.2654400078112959960719970586153501497,...
                0.62003539869325639760371263809929928256,...
                0.80167158471859684259236358940451923912 ];
            Qn.xi2 = [ 0.0000000000000000000000000000000000000,...
                0.0000000000000000000000000000000000000,...
                0.0000000000000000000000000000000000000,...
                0.80337972946768500184569945317555062404,...
                0.99216540589713472189744527407633022081,...
                0.92944960279960938592453972561789815525,...
                0.26664031459456217566653623598727229551,...
                0.98789293314173530957079377090965768822,...
                0.51249187721609765575479280145710018395,...
                0.86890243415450423858119610210847838329,...
                0.92630295580712924244748529919286127317,...
                0.98844653068397375168746156789890756035 ];
            Qn.w = [ 0.097737364692828748243518350785527543045,...
                0.13930761292248224570420924010933858068,...
                0.034869583491887910002162414690733291135,...
                0.047804547162795794795004833111469267529,...
                0.0016177151779117608109927450603284034943,...
                0.017441048034355762464098424359798214084,...
                0.11772583284005608002278985852480623731,...
                0.016179577611657849789658841248953982496,...
                0.082846618983404893940813472711113790502,...
                0.064989081492596046079059800766815612157,...
                0.038980552396410534776396621703868595797,...
                0.0098894009347434843812884009858441317495 ];
        end      
end

end%
%%
function Qn = quadSquareNonProductDegree20(varargin)
% Lower bound = 66

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 20, 78 Points, PI, Asymmetric, Reference: [X1] reported in
        % Table 3 on page 672 (numerical values obtained from their online
        % supplmental material).
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        
        Qn.m = ones(78,1);
        Qn.xi1 = [ 0.790355590129829,...
            0.225227378936246,...
           -0.137155620335223,...
            0.951691246765190,...
            0.898143861379740,...
            0.351132733693232,...
            0.097590683430625,...
           -0.192078170221083,...
            0.669543630688511,...
            0.583028950570239,...
           -0.427819022720551,...
            0.057278453165732,...
            0.735150720092607,...
            0.789893496423454,...
           -0.359439977748292,...
            0.337683918311245,...
            0.988639671491411,...
           -0.390772159666108,...
           -0.604689913975449,...
            0.917300715303028,...
           -0.041413969036599,...
           -0.638598289581018,...
            0.601339613443807,...
            0.916166166199854,...
           -0.327863985922172,...
            0.880246022798184,...
           -0.203458107806015,...
            0.696916639983928,...
            0.535159329380387,...
           -0.278774781983711,...
            0.991031447937170,...
           -0.825288926425955,...
           -0.959949120689160,...
            0.494491683571411,...
           -0.770389671618066,...
            0.912960483771139,...
            0.850037386649928,...
           -0.037554533546959,...
           -0.973457410521752,...
            0.289701677031343,...
            0.768843829066036,...
           -0.838861851699084,...
           -0.534128691368410,...
           -0.917480683143074,...
           -0.947434683884687,...
           -0.061319362631778,...
            0.760593310631715,...
           -0.984888646257559,...
           -0.757298782045933,...
            0.050807456822811,...
           -0.463655002935500,...
            0.970531924422749,...
           -0.891407994726378,...
           -0.987305695483006,...
           -0.975831337288964,...
           -0.881917086918621,...
           -0.970963589527841,...
            0.982272226270234,...
           -0.887350394289104,...
           -0.656924708204403,...
           -0.987090537362271,...
           -0.573467455165415,...
            0.015078886190834,...
            0.550605056055349,...
           -0.736683988577231,...
           -0.711702655633243,...
            0.233396592239589,...
           -0.287868115247493,...
            0.436174699035284,...
            0.981463389559936,...
           -0.531960163499169,...
            0.985098752202256,...
            0.195797282497072,...
            0.208421740019590,...
            0.475502772074220,...
            0.914749484368615,...
           -0.864568932816552,...
            0.677221207092729 ];
        Qn.xi2 = [   -0.088982481688451,...
           -0.072809539044851,...
           -0.865352420156083,...
           -0.290234658519753,...
            0.121866004809799,...
           -0.247122128270210,...
           -0.746791529620094,...
           -0.558983078908140,...
           -0.209065194159907,...
           -0.435570440609948,...
           -0.726477160564427,...
           -0.136359038895055,...
           -0.987851280266917,...
            0.920973773207876,...
           -0.953521739150114,...
           -0.595336123802652,...
           -0.075158637054292,...
            0.986549145205441,...
           -0.994093902917823,...
           -0.984083290419238,...
            0.082848985642712,...
           -0.866072058466825,...
            0.980945003785699,...
            0.804853349912937,...
            0.279028974015123,...
           -0.408274384303883,...
            0.974022665495887,...
            0.303569758201839,...
           -0.986272598512079,...
            0.718567295217056,...
           -0.919325614569451,...
           -0.954438424512673,...
           -0.989814634983996,...
            0.073389471362591,...
           -0.207533046378098,...
            0.990731899896839,...
            0.538798622046948,...
            0.883413145142967,...
           -0.893452263890975,...
           -0.920765697224696,...
           -0.636707611475453,...
            0.997891319631791,...
            0.530094394935641,...
           -0.426299825967388,...
            0.184114456716032,...
            0.509069104271246,...
           -0.921450161258118,...
           -0.640002781164244,...
            0.320923167891417,...
           -0.384663640517674,...
            0.869716109569750,...
            0.347009842836962,...
            0.571123931193509,...
            0.406791291429793,...
            0.762478652445822,...
           -0.777014374525921,...
            0.958435680255077,...
            0.655197397645968,...
            0.028545787727207,...
            0.955161978068076,...
           -0.167518567702980,...
            0.042400212843295,...
           -0.986454503960649,...
           -0.798955027886182,...
           -0.607183999696622,...
            0.738867205408202,...
            0.314077512069275,...
           -0.179382635380280,...
            0.877233698204943,...
           -0.603307689849467,...
           -0.403980518928954,...
            0.928249862549075,...
            0.718509878376443,...
            0.975809076098629,...
            0.538825545534923,...
           -0.802021243175542,...
            0.881433597644919,...
            0.739326748786804 ];
        Qn.w = [ 0.059691281598230,...
            0.059545020382775,...
            0.058145321847650,...
            0.022665923467032,...
            0.051194065051477,...
            0.080889636133250,...
            0.078544461522526,...
            0.099390188730238,...
            0.054832228471299,...
            0.079417687672138,...
            0.079647757987957,...
            0.026582651674851,...
            0.001856943247818,...
            0.029828900971153,...
            0.034669167330478,...
            0.092721810004885,...
            0.015828377299190,...
            0.010062925779008,...
            0.009495171620836,...
            0.008323819832227,...
            0.117508185028318,...
            0.050782546480554,...
            0.017622906439958,...
            0.028551259360019,...
            0.119526726306184,...
            0.045943455672118,...
            0.018971829504328,...
            0.091541128358185,...
            0.016196100112055,...
            0.083052698265834,...
            0.006376631911872,...
            0.021119911143429,...
            0.003768904506335,...
            0.108962414915352,...
            0.080991365260831,...
            0.006403846513640,...
            0.060525756735492,...
            0.060605862620851,...
            0.011415694760965,...
            0.052344618138454,...
            0.065242312488915,...
            0.005609045829389,...
            0.096009334952417,...
            0.049227547705821,...
            0.027703703053861,...
            0.113050454590628,...
            0.034412967828469,...
            0.015032949378810,...
            0.087264900853697,...
            0.106376878833305,...
            0.051216366817072,...
            0.026008005827601,...
            0.051417985692618,...
            0.015380449168072,...
            0.017473005130118,...
            0.037769069336539,...
            0.008140560550228,...
            0.014374212737193,...
            0.044623465511292,...
            0.026073785474302,...
            0.019273559493088,...
            0.113856098790220,...
            0.019995333543228,...
            0.070983819569712,...
            0.072072790057625,...
            0.063524900182586,...
            0.121934711408448,...
            0.127739827178937,...
            0.059601000096145,...
            0.018606358989187,...
            0.103355984699723,...
            0.007243885756143,...
            0.094080114226499,...
            0.026709615274027,...
            0.101301034994317,...
            0.033262308047399,...
            0.030653291281114,...
            0.067853181991462 ];
    case 'full'
        % _________________________________________________________________
        % Degree 20 (actually 21), 85 Points, PI, Fully symmetric, 
        % Reference: [W2] reported as new in Table 1 on page 1240 
        % (numerical values obtained from their online supplemental 
        % material.)
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn = quadSquareNonProductDegree21(varargin{:});
end         
        
end%
%%
function Qn = quadSquareNonProductDegree21(varargin)
% Lower bound = 71

switch varargin{1}
    case 'allowAsymmetric'
        % _________________________________________________________________
        % Degree 21, 81 Points, PI, Rotationally symmetric, Reference: [O1] 
        % see Table 5 on page 201.
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = {'n0','R4','R4','R4','R4','R4','R4','R4','R4','R4','R4',...
            'R4','R4','R4','R4','R4','R4','R4','R4','R4','R4'};
        Qn.m = [ 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 ];
        Qn.xi1 = [ 0.00000000000000000000000000000000,...
            0.99742844318071465788852153329446,...
            0.90092205722857715090631770295789,...
            0.98137581661152322617866583081353,...
            0.47562398846061921636952360049609,...
            0.68396217875524370909034162562144e-1,...
            0.96445171170290974019893928634261,...
            0.96789534067760540982739074113386,...
            0.71204626183902144323409345553631,...
            0.86686503563504933746419509606443,...
            0.29388895765490255861532312924984,...
            0.88245289720509646533706783064117,...
            0.88356465549777630296872390851348,...
            0.53714330328796591598235477256257,...
            0.73297737278688849035966507531475,...
            0.74340815897994389367005251095709,...
            0.14352379867257862891820869134808,...
            0.57716374806487034338151001622839,...
            0.38010653105519745774291045326124,...
            0.49380304750704567296572150088764,...
            0.23300694276964919884562248755586 ];
        Qn.xi2 = [ 0.00000000000000000000000000000000,...
            0.52349333540342268677302187698119,...
            0.99213624611198765984022577926158,...
            0.93577766500519228442627576803182,...
            0.98806503981406364167006543205075,...
            0.98289142121346795894575007552095,...
            0.73079564192792033198229729840349,...
            0.28416943704022564251542547384397,...
            0.95001737577395264422880843244573,...
            0.85754514904426211818642071770359,...
            0.91478375374420147743639913929870,...
            0.78310571319347967606817150072422e-1,...
            0.50650027819745540446699219481203,...
            0.82111662321535962574448188332070,...
            0.67811474157990352881988795983159,...
            0.25891212405917942502949658613377,...
            0.73714284444878233387764988974016,...
            0.42605137832252378501649531823938,...
            0.59190980196005469388929534014808,...
            0.46968438389915362845722235027390e-1,...
            0.27854054992870057594151995625227 ];
        Qn.w = [ 0.13498395305263979164774737575571,...
            0.59245289910274777823163684444026e-2,...
            0.63181879993530976749052313712955e-2,...
            0.77654356771885822575525989789117e-2,...
            0.13313236524649387539261801099149e-1,...
            0.18028023632000303112294832251383e-1,...
            0.20759211084811453614957408545828e-1,...
            0.24345594686962939048122829629801e-1,...
            0.27291829813157459363923440908365e-1,...
            0.31313724489320677669626239379042e-1,...
            0.43028684463625497581941353350492e-1,...
            0.47435107497760585342967184111271e-1,...
            0.49535232791099913534195616930148e-1,...
            0.59086609737522776429493659734483e-1,...
            0.61598898755573131953283218720393e-1,...
            0.68662882737105569078247834904061e-1,...
            0.77511025760449779132628565445376e-1,...
            0.77655900861398148704502327066780e-1,...
            0.84165159143253389201574044182295e-1,...
            0.11664395742356559711226466539621,...
            0.12587077966701428595400393561138 ];
    case 'full'
        % _________________________________________________________________
        % Degree 21, 85 Points, PI, Fully symmetric, Reference: [W2]
        % reported as new in Table 1 on page 1240 (numerical values
        % obtained from their online supplemental material.)
        % ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Qn.group = {'n0','n1','n1','n2','n2','n2','n2','n2',...
            'n3','n3','n3','n3','n3','n3','n3'};
        Qn.m = [ 1 4 4 4 4 4 4 4 8 8 8 8 8 8 8 ];
        Qn.xi1 = [ 0.00000000000000000000000000000000000000,...
            0.47335107435822415202690901838844666219,...
            0.83527842975586830160520893009495292054,...
            0.2573719006072289819053755213317636919,...
            0.96333783211562335381484352624945730322,...
            0.86245192537965155140267607631968215083,...
            0.49689796251934570364793617005129236026,...
            0.70433217519540056955932591780080720749,...
            0.24187818547670197670997054949192246819,...
            0.48015696631279513715726389107913072158,...
            0.93224193592175396207500211941993080129,...
            0.93490232582401054613354438740771124115,...
            0.99045546752952415272197458895882111757,...
            0.83113524597590138585974389212898407353,...
            0.091469600922291296668443828573471880948 ];
        Qn.xi2 = [ 0.00000000000000000000000000000000000000,...
            0.00000000000000000000000000000000000000,...
            0.00000000000000000000000000000000000000,...
            0.2573719006072289819053755213317636919,...
            0.96333783211562335381484352624945730322,...
            0.86245192537965155140267607631968215083,...
            0.49689796251934570364793617005129236026,...
            0.70433217519540056955932591780080720749,...
            0.67414621995531773950245618191533516236,...
            0.82464737527092073827881221191700729562,...
            0.27069918410166491089101469370373344757,...
            0.67503956743707526937208896355984125883,...
            0.48891625117716687937811887553934444444,...
            0.98896061138657239166243578378631145048,...
            0.98401714848959892866013755872564589893 ];
        Qn.w = [ 0.13519284035614282527922840385434746149,...
            0.1067941587859403825037542148829566842,...
            0.066257208004944385159031059020122440339,...
            0.11988448364634046970472217835662908028,...
            0.0082294612892200088282217117254895783997,...
            0.030603640928775651038141155704768806683,...
            0.096791791893595210842497711127833756611,...
            0.061516341481316561201749944009961586508,...
            0.086728499513208224903936696999552926752,...
            0.055879117404127348063047858204117827292,...
            0.037128827440913817653330718954876960924,...
            0.028775600851020531767579367626940765984,...
            0.011509520442493167578261138308188460848,...
            0.0075284821304016457091249399363317448912,...
            0.010512304158251076525756742074316914114 ];
end

end%
%%
function Q  = quadSquareNonProductPointsAndWeights(Qn)

Q.Points = zeros(sum(Qn.m),2); Q.Weights = zeros(sum(Qn.m),1);
k = 1;
for i = 1:length(Qn.m)
    switch Qn.m(i)
        case 1            
            % Type n0 orbit as defined in Table I of [D1], see page 1779 
            % (or a single asymmetric point)
            Q.Points(k+Qn.m(i)-1,1)  = Qn.xi1(i);
            Q.Points(k+Qn.m(i)-1,2)  = Qn.xi2(i);
            Q.Weights(k:k+Qn.m(i)-1) = Qn.w(i);
            k = k + Qn.m(i);
        case 2
            switch Qn.group{i}
                case 's2'
                    % Type s2 orbit as defined in [W1], see page 683. 
                    % (Note: This is reflection about the vertical axis)
                    Q.Points(k:k+Qn.m(i)-1,1) = [ Qn.xi1(i), -Qn.xi1(i) ];
                    Q.Points(k:k+Qn.m(i)-1,2) = [ Qn.xi2(i),  Qn.xi2(i) ];
                    Q.Weights(k:k+Qn.m(i)-1)  = Qn.w(i);
                case 'ReflectionX'
            end
            k = k + Qn.m(i);
        case 4
            switch Qn.group{i}
                case 'n1'
                    % Type n1 orbit as defined in Table I of [D1], see page 
                    % 1779 
                    Q.Points(k:k+Qn.m(i)-1,1) = ...
                        [ Qn.xi1(i), -Qn.xi1(i), 0, 0 ];
                    Q.Points(k:k+Qn.m(i)-1,2) = ...
                        [ 0, 0, Qn.xi1(i), -Qn.xi1(i) ];
                    Q.Weights(k:k+Qn.m(i)-1)  = Qn.w(i);
                    k = k + Qn.m(i);
                case 'n2'
                    % Type n2 orbit as defined in Table I of [D1], see page 
                    % 1779 
                    Q.Points(k:k+Qn.m(i)-1,1) = [ +Qn.xi1(i), +Qn.xi1(i),...
                        -Qn.xi1(i), -Qn.xi1(i) ];
                    Q.Points(k:k+Qn.m(i)-1,2) = [ +Qn.xi1(i), -Qn.xi1(i),...
                        -Qn.xi1(i), +Qn.xi1(i) ];
                    Q.Weights(k:k+Qn.m(i)-1) = Qn.w(i);
                    k = k + Qn.m(i);                  
                case 'R4'
                    % Rotational orbits as defined in [M2], see page 194.
                    Q.Points(k:k+Qn.m(i)-1,1) = [ -Qn.xi1(i), -Qn.xi2(i),...
                        +Qn.xi2(i), +Qn.xi1(i) ];
                    Q.Points(k:k+Qn.m(i)-1,2) = [ -Qn.xi2(i), +Qn.xi1(i),...
                        -Qn.xi1(i), +Qn.xi2(i) ];
                    Q.Weights(k:k+Qn.m(i)-1)  = Qn.w(i);
                    k = k + Qn.m(i);
            end
        case 8
            % Type n3 orbit as defined in Table I of [D1], see page 1779
            Q.Points(k:k+Qn.m(i)-1,1) = [ ...
                +Qn.xi1(i), +Qn.xi1(i), -Qn.xi1(i), -Qn.xi1(i), ... 
                +Qn.xi2(i), +Qn.xi2(i), -Qn.xi2(i), -Qn.xi2(i) ];
            Q.Points(k:k+Qn.m(i)-1,2) = [ ...
                +Qn.xi2(i), -Qn.xi2(i), -Qn.xi2(i), +Qn.xi2(i), ...
                +Qn.xi1(i), -Qn.xi1(i), -Qn.xi1(i), +Qn.xi1(i) ];
            Q.Weights(k:k+Qn.m(i)-1) = Qn.w(i);
            k = k + Qn.m(i);
    end
end

end


    
    
    
    
